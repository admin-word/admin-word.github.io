import{p as A,m as x,r as S}from"./vendor-B1gV91ol.js";import{a as $}from"./index-t--hEgTQ.js";import{U as Q}from"./index-h4SDZcon.js";import{b as R,d as I}from"./vendor-store-zNU_bmKY.js";var T={VITE_API_SERVER:"https://posstree.com/api/word_app"};const U=`${T.VITE_API_SERVER}/admin/add/query`,L=async({token:r,appName:n,seq:t,userQuery:e,word:i,modifiedWord:o,originalMeaning:m,modifiedMeaning:d,originalPronunciation:_,modifiedPronunciation:v,originalExample:w,modifiedExample:f,originalExampleMeaning:g,modifiedExampleMeaning:a,originalWordClass:s,modifiedWordClass:u,deviceUniqueId:p,os:c})=>{await $.post(U,{token:r,appName:n,seq:t,userQuery:e,word:i,modified_word:o,original_meaning:m,modified_meaning:d,original_pronunciation:_,modified_pronunciation:v,original_example:w,modified_example:f,original_example_meaning:g,modified_example_meaning:a,original_word_class:s,modified_word_class:u,device_unique_id:p,os:c})};var P={VITE_API_SERVER:"https://posstree.com/api/word_app"};const V=`${P.VITE_API_SERVER}/admin/word_apps`,W=async({token:r})=>(await $.post(V,{token:r})).data.sort((t,e)=>e.count-t.count),M=r=>["AppList",r],C=({token:r})=>A({queryKey:M(r),queryFn:async()=>W({token:r}),staleTime:1/0,gcTime:1/0}),N=({onSuccess:r,onError:n})=>x({mutationFn:L,onSuccess:r,onError:n}),X=({onSuccess:r,onError:n})=>{const{token:t}=R(Q),{mutate:e}=N({onSuccess:r,onError:n});return{addWrongPronunciation:({seq:o,appName:m,word:d,modifiedWord:_,originalMeaning:v,modifiedMeaning:w,originalPronunciation:f,modifiedPronunciation:g,originalExample:a,modifiedExample:s,originalExampleMeaning:u,modifiedExampleMeaning:p,originalWordClass:c,modifiedWordClass:h,deviceUniqueId:y,os:E})=>{const l=`
      INSERT INTO wrong_pronunciation_words (word)
      SELECT "${d}"
      WHERE NOT EXISTS (
        SELECT 1 FROM wrong_pronunciation_words WHERE word = "${d}"
      );
    `.trim();e({token:t,seq:o,appName:m,userQuery:l,word:d,modifiedWord:_,originalMeaning:v,modifiedMeaning:w,originalPronunciation:f,modifiedPronunciation:g,originalExample:a,modifiedExample:s,originalExampleMeaning:u,modifiedExampleMeaning:p,originalWordClass:c,modifiedWordClass:h,deviceUniqueId:y,os:E})}}},Y=({onError:r})=>{const{token:n}=R(Q),{isLoading:t,data:e,isError:i,error:o}=C({token:n});return S.useEffect(()=>{i&&r(o)},[i,o,r]),{isLoadingApps:t,data:e}},z=I(void 0),D=(r,n="")=>{const t=r.trim(),e=n.trim();return t===e?{update:void 0,where:void 0}:e!==""?{update:`word="${e}"`,where:void 0}:{update:void 0,where:void 0}},q=(r="",n="")=>{const t=r.trim(),e=n.trim();if(t===e)return{update:void 0,where:void 0};if(e!==""){const i=`meaning="${e}"`;if(t!==""){const o=`meaning="${t}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},O=(r="",n="")=>{const t=r.trim(),e=n.trim();if(t===e)return{update:void 0,where:void 0};if(e!==""){const i=`pronunciation="${e}"`;if(t!==""){const o=`pronunciation="${t}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},F=(r="",n="")=>{const t=r.trim(),e=n.trim();if(t===e)return{update:void 0,where:void 0};if(e!==""){const i=`example="${e}"`;if(t!==""){const o=`example="${t}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},G=(r="",n="")=>{const t=r.trim(),e=n.trim();if(t===e)return{update:void 0,where:void 0};if(e!==""){const i=`example_meaning="${e}"`;if(t!==""){const o=`example_meaning="${t}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},H=(r="",n="")=>{const t=r.trim(),e=n.trim();if(t===e)return{update:void 0,where:void 0};if(e!==""){const i=`word_class="${e}"`;if(t!==""){const o=`word_class="${t}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},B=({seq:r,word:n,editedWord:t,editedPronunciation:e,originalPronunciation:i,editedMeaning:o,originalMeaning:m,editedExample:d,originalExample:_,editedExampleMeaning:v,originalExampleMeaning:w,editedWordClass:f,originalWordClass:g})=>{if(r===void 0||n===void 0)return;const a=D(n,t),s=O(i,e),u=q(m,o),p=F(_,d),c=G(w,v),h=H(g,f);if(a.update===void 0&&s.update===void 0&&u.update===void 0&&p.update===void 0&&c.update===void 0&&h.update===void 0)return;const y=[a.update,s.update,u.update,p.update,c.update,h.update].filter(l=>l!==void 0),E=[a.where,s.where,u.where,p.where,c.where,h.where].filter(l=>l!==void 0);return`
UPDATE words SET
  ${y.join(`,
  `)}
WHERE seq=${r}
AND word="${n}"
${E.length>0?`AND ${E.join(`
AND `)}`:""};
  `.trim()};export{z as S,N as a,X as b,B as c,M as g,Y as u};
