import{p as R,m as A,r as Q}from"./vendor-B1gV91ol.js";import{a as h}from"./index-t--hEgTQ.js";import{U as y}from"./index-BX_kuCcN.js";import{b as l,d as x}from"./vendor-store-zNU_bmKY.js";var S={VITE_API_SERVER:"https://posstree.com/api/word_app"};const I=`${S.VITE_API_SERVER}/admin/add/query`,T=async({token:t,appName:r,seq:n,userQuery:e,word:i,modifiedWord:o,originalMeaning:m,modifiedMeaning:a,originalPronunciation:_,modifiedPronunciation:v,originalExample:g,modifiedExample:d,originalExampleMeaning:s,modifiedExampleMeaning:u,deviceUniqueId:p,os:c})=>{await h.post(I,{token:t,appName:r,seq:n,userQuery:e,word:i,modified_word:o,original_meaning:m,modified_meaning:a,original_pronunciation:_,modified_pronunciation:v,original_example:g,modified_example:d,original_example_meaning:s,modified_example_meaning:u,device_unique_id:p,os:c})};var U={VITE_API_SERVER:"https://posstree.com/api/word_app"};const L=`${U.VITE_API_SERVER}/admin/word_apps`,P=async({token:t})=>(await h.post(L,{token:t})).data.sort((n,e)=>e.count-n.count),V=t=>["AppList",t],W=({token:t})=>R({queryKey:V(t),queryFn:async()=>P({token:t}),staleTime:1/0,gcTime:1/0}),M=({onSuccess:t,onError:r})=>A({mutationFn:T,onSuccess:t,onError:r}),j=({onSuccess:t,onError:r})=>{const{token:n}=l(y),{mutate:e}=M({onSuccess:t,onError:r});return{addWrongPronunciation:({seq:o,appName:m,word:a,modifiedWord:_,originalMeaning:v,modifiedMeaning:g,originalPronunciation:d,modifiedPronunciation:s,originalExample:u,modifiedExample:p,originalExampleMeaning:c,modifiedExampleMeaning:E,deviceUniqueId:w,os:f})=>{const $=`
      INSERT INTO wrong_pronunciation_words (word)
      SELECT "${a}"
      WHERE NOT EXISTS (
        SELECT 1 FROM wrong_pronunciation_words WHERE word = "${a}"
      );
    `.trim();e({token:n,seq:o,appName:m,userQuery:$,word:a,modifiedWord:_,originalMeaning:v,modifiedMeaning:g,originalPronunciation:d,modifiedPronunciation:s,originalExample:u,modifiedExample:p,originalExampleMeaning:c,modifiedExampleMeaning:E,deviceUniqueId:w,os:f})}}},K=({onError:t})=>{const{token:r}=l(y),{isLoading:n,data:e,isError:i,error:o}=W({token:r});return Q.useEffect(()=>{i&&t(o)},[i,o,t]),{isLoadingApps:n,data:e}},k=x(void 0),N=(t,r="")=>{const n=t.trim(),e=r.trim();return n===e?{update:void 0,where:void 0}:e!==""?{update:`word="${e}"`,where:void 0}:{update:void 0,where:void 0}},D=(t="",r="")=>{const n=t.trim(),e=r.trim();if(n===e)return{update:void 0,where:void 0};if(e!==""){const i=`meaning="${e}"`;if(n!==""){const o=`meaning="${n}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},q=(t="",r="")=>{const n=t.trim(),e=r.trim();if(n===e)return{update:void 0,where:void 0};if(e!==""){const i=`pronunciation="${e}"`;if(n!==""){const o=`pronunciation="${n}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},C=(t="",r="")=>{const n=t.trim(),e=r.trim();if(n===e)return{update:void 0,where:void 0};if(e!==""){const i=`example="${e}"`;if(n!==""){const o=`example="${n}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},O=(t="",r="")=>{const n=t.trim(),e=r.trim();if(n===e)return{update:void 0,where:void 0};if(e!==""){const i=`example_meaning="${e}"`;if(n!==""){const o=`example_meaning="${n}"`;return{update:i,where:o}}return{update:i,where:void 0}}return{update:void 0,where:void 0}},X=({seq:t,word:r,editedWord:n,editedPronunciation:e,originalPronunciation:i,editedMeaning:o,originalMeaning:m,editedExample:a,originalExample:_,editedExampleMeaning:v,originalExampleMeaning:g})=>{if(t===void 0||r===void 0)return;const d=N(r,n),s=q(i,e),u=D(m,o),p=C(_,a),c=O(g,v);if(d.update===void 0&&s.update===void 0&&u.update===void 0&&p.update===void 0&&c.update===void 0)return;const E=[d.update,s.update,u.update,p.update,c.update].filter(f=>f!==void 0),w=[d.where,s.where,u.where,p.where,c.where].filter(f=>f!==void 0);return`
UPDATE words SET
  ${E.join(`,
  `)}
WHERE seq=${t}
AND word="${r}"
${w.length>0?`AND ${w.join(`
AND `)}`:""};
  `.trim()};export{k as S,M as a,j as b,X as c,V as g,K as u};
