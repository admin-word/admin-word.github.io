import{r as I,R as le}from"./vendor-B1gV91ol.js";const D={},Y=(e,n)=>e.unstable_is?e.unstable_is(n):n===e,Z=e=>"init"in e,C=e=>!!e.write,k=e=>"v"in e||"e"in e,x=e=>{if("e"in e)throw e.e;if((D?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},J=new WeakMap,B=e=>{var n;return M(e)&&!!((n=J.get(e))!=null&&n[0])},de=e=>{const n=J.get(e);n!=null&&n[0]&&(n[0]=!1,n[1].forEach(t=>t()))},te=(e,n)=>{let t=J.get(e);if(!t){t=[!0,new Set],J.set(e,t);const o=()=>{t[0]=!1};e.then(o,o)}t[1].add(n)},M=e=>typeof(e==null?void 0:e.then)=="function",ne=(e,n,t)=>{t.p.has(e)||(t.p.add(e),n.then(()=>{t.p.delete(e)},()=>{t.p.delete(e)}))},G=(e,n,t)=>{const o=t(e),f="v"in o,a=o.v;if(M(n))for(const d of o.d.keys())ne(e,n,t(d));o.v=n,delete o.e,(!f||!Object.is(a,o.v))&&(++o.n,M(a)&&de(a))},m=(e,n,t)=>{var o;const f=new Set;for(const a of((o=t.get(e))==null?void 0:o.t)||[])t.has(a)&&f.add(a);for(const a of n.p)f.add(a);return f},fe=()=>{const e=new Set,n=()=>{e.forEach(t=>t())};return n.add=t=>(e.add(t),()=>{e.delete(t)}),n},K=()=>{const e={},n=new WeakMap,t=o=>{var f,a;(f=n.get(e))==null||f.forEach(d=>d(o)),(a=n.get(o))==null||a.forEach(d=>d())};return t.add=(o,f)=>{const a=o||e,d=(n.has(a)?n:n.set(a,new Set)).get(a);return d.add(f),()=>{d==null||d.delete(f),d.size||n.delete(a)}},t},ae=e=>(e.c||(e.c=K()),e.m||(e.m=K()),e.u||(e.u=K()),e.f||(e.f=fe()),e),ve=Symbol(),_e=(e=new WeakMap,n=new WeakMap,t=new WeakMap,o=new Set,f=new Set,a=new Set,d={},v=(w,...p)=>w.read(...p),h=(w,...p)=>w.write(...p),i=(w,p)=>{var g;return(g=w.unstable_onInit)==null?void 0:g.call(w,p)},S=(w,p)=>{var g;return(g=w.onMount)==null?void 0:g.call(w,p)},...y)=>{const w=y[0]||(r=>{if((D?"production":void 0)!=="production"&&!r)throw new Error("Atom is undefined or null");let _=e.get(r);return _||(_={d:new Map,p:new Set,n:0},e.set(r,_),i==null||i(r,$)),_}),p=y[1]||(()=>{const r=[],_=l=>{try{l()}catch(c){r.push(c)}};do{d.f&&_(d.f);const l=new Set,c=l.add.bind(l);o.forEach(s=>{var u;return(u=n.get(s))==null?void 0:u.l.forEach(c)}),o.clear(),a.forEach(c),a.clear(),f.forEach(c),f.clear(),l.forEach(_),o.size&&g()}while(o.size||a.size||f.size);if(r.length)throw new AggregateError(r)}),g=y[2]||(()=>{const r=[],_=new WeakSet,l=new WeakSet,c=Array.from(o);for(;c.length;){const s=c[c.length-1],u=w(s);if(l.has(s)){c.pop();continue}if(_.has(s)){if(t.get(s)===u.n)r.push([s,u]);else if((D?"production":void 0)!=="production"&&t.has(s))throw new Error("[Bug] invalidated atom exists");l.add(s),c.pop();continue}_.add(s);for(const E of m(s,u,n))_.has(E)||c.push(E)}for(let s=r.length-1;s>=0;--s){const[u,E]=r[s];let A=!1;for(const R of E.d.keys())if(R!==u&&o.has(R)){A=!0;break}A&&(P(u),O(u)),t.delete(u)}}),P=y[3]||(r=>{var _;const l=w(r);if(k(l)&&(n.has(r)&&t.get(r)!==l.n||Array.from(l.d).every(([b,V])=>P(b).n===V)))return l;l.d.clear();let c=!0;const s=()=>{n.has(r)&&(O(r),g(),p())},u=b=>{var V;if(Y(r,b)){const X=w(b);if(!k(X))if(Z(b))G(b,b.init,w);else throw new Error("no atom init");return x(X)}const U=P(b);try{return x(U)}finally{l.d.set(b,U.n),B(l.v)&&ne(r,l.v,U),(V=n.get(b))==null||V.t.add(r),c||s()}};let E,A;const R={get signal(){return E||(E=new AbortController),E.signal},get setSelf(){return(D?"production":void 0)!=="production"&&!C(r)&&console.warn("setSelf function cannot be used with read-only atom"),!A&&C(r)&&(A=(...b)=>{if((D?"production":void 0)!=="production"&&c&&console.warn("setSelf function cannot be called in sync"),!c)try{return T(r,...b)}finally{g(),p()}}),A}},z=l.n;try{const b=v(r,u,R);return G(r,b,w),M(b)&&(te(b,()=>E==null?void 0:E.abort()),b.then(s,s)),l}catch(b){return delete l.v,l.e=b,++l.n,l}finally{c=!1,z!==l.n&&t.get(r)===z&&(t.set(r,l.n),o.add(r),(_=d.c)==null||_.call(d,r))}}),j=y[4]||(r=>{const _=[r];for(;_.length;){const l=_.pop(),c=w(l);for(const s of m(l,c,n)){const u=w(s);t.set(s,u.n),_.push(s)}}}),T=y[5]||((r,..._)=>{let l=!0;const c=u=>x(P(u)),s=(u,...E)=>{var A;const R=w(u);try{if(Y(r,u)){if(!Z(u))throw new Error("atom not writable");const z=R.n,b=E[0];G(u,b,w),O(u),z!==R.n&&(o.add(u),(A=d.c)==null||A.call(d,u),j(u));return}else return T(u,...E)}finally{l||(g(),p())}};try{return h(r,c,s,..._)}finally{l=!1}}),O=y[6]||(r=>{var _;const l=w(r),c=n.get(r);if(c&&!B(l.v)){for(const[s,u]of l.d)if(!c.d.has(s)){const E=w(s);N(s).t.add(r),c.d.add(s),u!==E.n&&(o.add(s),(_=d.c)==null||_.call(d,s),j(s))}for(const s of c.d||[])if(!l.d.has(s)){c.d.delete(s);const u=W(s);u==null||u.t.delete(r)}}}),N=y[7]||(r=>{var _;const l=w(r);let c=n.get(r);if(!c){P(r);for(const s of l.d.keys())N(s).t.add(r);if(c={l:new Set,d:new Set(l.d.keys()),t:new Set},n.set(r,c),(_=d.m)==null||_.call(d,r),C(r)){const s=()=>{let u=!0;const E=(...A)=>{try{return T(r,...A)}finally{u||(g(),p())}};try{const A=S(r,E);A&&(c.u=()=>{u=!0;try{A()}finally{u=!1}})}finally{u=!1}};f.add(s)}}return c}),W=y[8]||(r=>{var _;const l=w(r);let c=n.get(r);if(c&&!c.l.size&&!Array.from(c.t).some(s=>{var u;return(u=n.get(s))==null?void 0:u.d.has(r)})){c.u&&a.add(c.u),c=void 0,n.delete(r),(_=d.u)==null||_.call(d,r);for(const s of l.d.keys()){const u=W(s);u==null||u.t.delete(r)}return}return c}),ue=[e,n,t,o,f,a,d,v,h,i,S,w,p,g,P,j,T,O,N,W],$={get:r=>x(P(r)),set:(r,..._)=>{try{return T(r,..._)}finally{g(),p()}},sub:(r,_)=>{const c=N(r).l;return c.add(_),p(),()=>{c.delete(_),W(r),p()}}};return Object.defineProperty($,ve,{value:ue}),$},re=_e,we=ae,H=te,F={};let he=0;function ee(e,n){const t=`atom${++he}`,o={toString(){return(F?"production":void 0)!=="production"&&this.debugLabel?t+":"+this.debugLabel:t}};return typeof e=="function"?o.read=e:(o.init=e,o.read=Se,o.write=pe),n&&(o.write=n),o}function Se(e){return e(this)}function pe(e,n,t){return n(this,typeof t=="function"?t(e(this)):t)}const ye=()=>{let e=0;const n=we({}),t=new WeakMap,o=new WeakMap,f=re(t,o,void 0,void 0,void 0,void 0,n,void 0,(v,h,i,...S)=>e?i(v,...S):v.write(h,i,...S)),a=new Set;return n.m.add(void 0,v=>{a.add(v);const h=t.get(v);h.m=o.get(v)}),n.u.add(void 0,v=>{a.delete(v);const h=t.get(v);delete h.m}),Object.assign(f,{dev4_get_internal_weak_map:()=>t,dev4_get_mounted_atoms:()=>a,dev4_restore_atoms:v=>{const h={read:()=>null,write:(i,S)=>{++e;try{for(const[y,w]of v)"init"in y&&S(y,w)}finally{--e}}};f.set(h)}})};function oe(){return(F?"production":void 0)!=="production"?ye():re()}let L;function be(){return L||(L=oe(),(F?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=L),globalThis.__JOTAI_DEFAULT_STORE__!==L&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),L}const ge={},ie=I.createContext(void 0);function se(e){return I.useContext(ie)||be()}function We({children:e,store:n}){const t=I.useRef(void 0);return!n&&!t.current&&(t.current=oe()),I.createElement(ie.Provider,{value:n||t.current},e)}const ce=e=>typeof(e==null?void 0:e.then)=="function",Ee=e=>{e.status="pending",e.then(n=>{e.status="fulfilled",e.value=n},n=>{e.status="rejected",e.reason=n})},Ae=le.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(Ee(e),e)}),q=new WeakMap,Pe=(e,n)=>{let t=q.get(e);return t||(t=new Promise((o,f)=>{let a=e;const d=i=>S=>{a===i&&o(S)},v=i=>S=>{a===i&&f(S)},h=()=>{try{const i=n();ce(i)?(q.set(i,t),a=i,i.then(d(i),v(i)),H(i,h)):o(i)}catch(i){f(i)}};e.then(d(e),v(e)),H(e,h)}),q.set(e,t)),t};function Ie(e,n){const t=se(),[[o,f,a],d]=I.useReducer(i=>{const S=t.get(e);return Object.is(i[0],S)&&i[1]===t&&i[2]===e?i:[S,t,e]},void 0,()=>[t.get(e),t,e]);let v=o;if((f!==t||a!==e)&&(d(),v=t.get(e)),I.useEffect(()=>{const i=t.sub(e,()=>{d()});return d(),i},[t,e,void 0]),I.useDebugValue(v),ce(v)){const i=Pe(v,()=>t.get(e));return Ae(i)}return v}function Re(e,n){const t=se();return I.useCallback((...f)=>{if((ge?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return t.set(e,...f)},[t,e])}function ze(e,n){return[Ie(e),Re(e)]}const Q={},Te=Symbol((Q?"production":void 0)!=="production"?"RESET":""),Le=e=>typeof(e==null?void 0:e.then)=="function";function De(e=()=>{try{return window.localStorage}catch(t){(Q?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(t);return}},n){var t;let o,f;const a={getItem:(h,i)=>{var S,y;const w=g=>{if(g=g||"",o!==g){try{f=JSON.parse(g,n==null?void 0:n.reviver)}catch{return i}o=g}return f},p=(y=(S=e())==null?void 0:S.getItem(h))!=null?y:null;return Le(p)?p.then(w):w(p)},setItem:(h,i)=>{var S;return(S=e())==null?void 0:S.setItem(h,JSON.stringify(i,void 0))},removeItem:h=>{var i;return(i=e())==null?void 0:i.removeItem(h)}},d=h=>(i,S,y)=>h(i,w=>{let p;try{p=JSON.parse(w||"")}catch{p=y}S(p)});let v;try{v=(t=e())==null?void 0:t.subscribe}catch{}return!v&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(v=(h,i)=>{if(!(e()instanceof window.Storage))return()=>{};const S=y=>{y.storageArea===e()&&y.key===h&&i(y.newValue)};return window.addEventListener("storage",S),()=>{window.removeEventListener("storage",S)}}),v&&(a.subscribe=d(v)),a}const Oe=De();function Ve(e,n,t=Oe,o){const f=ee(n);return(Q?"production":void 0)!=="production"&&(f.debugPrivate=!0),f.onMount=d=>{d(t.getItem(e,n));let v;return t.subscribe&&(v=t.subscribe(e,d,n)),v},ee(d=>d(f),(d,v,h)=>{const i=typeof h=="function"?h(d(f)):h;return i===Te?(v(f,n),t.removeItem(e)):i instanceof Promise?i.then(S=>(v(f,S),t.setItem(e,S))):(v(f,i),t.setItem(e,i))})}export{We as P,Ve as a,Ie as b,ze as c,ee as d,Re as u};
